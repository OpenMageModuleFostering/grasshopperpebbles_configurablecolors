(function(e){e.fn.extend({gpConfigurableColors:function(t){opts=e.extend({},e.configurableColors.defaults,t);return this.each(function(){new e.configurableColors(this,opts)})}});e.configurableColors=function(t,n){function h(t){var r=e.parseJSON(t);u=r.hasGender==""?false:true;var i=p(r.items);i=d(0);var s=e("#"+n.swatch_container+" a")[0];g(e(s))}function p(t){var n=[];if(u){var r=[];e.each(t,function(n,i){if(r.indexOf(i.gender)==-1){r.push(i.gender);o[o.length]=e(t).filter(function(){return this.gender==i.gender})}})}else{var i=[];e.each(t,function(n,r){if(i.indexOf(r.item_size)==-1){i.push(r.item_size);o[o.length]=e(t).filter(function(){return this.item_size==r.item_size})}})}return true}function d(t){var r=n.color_map;var i,s,u,a,f;e.each(o[t],function(t,o){i=o.color_name;a=false;if(r.length>0){s=e(r).filter(function(){return this.color_name==o.color_name});if(s.length>0){if("color_hex"in s[0]){i=s[0]["color_hex"]}else if("color_class"in s[0]){a=true;f=s[0]["color_class"]}}}u=e("<a />").addClass(n.swatch_class);if(a){e(u).addClass(f)}else{e(u).css("background-color",i)}e(u).attr("title",o.color_name).appendTo(e("#"+n.swatch_container)).data("settings",{color_id:o.color_id,color:i,isClass:a,assoc_id:o.assoc_id,large_src:o.large_src,zoom_src:o.zoom_src,thumbs:o.thumbs}).click(function(){g(e(this))})});return true}function v(t){var n=spConfig.settings[s];e(n).val(t);var r=e(n).prop("selectedIndex");spConfig.settings[s].selectedIndex=r;var i=spConfig.settings[s];++s;Event.observe(i,"change",function(){});m(i,"change");if(u&&!a){a=true;setTimeout(function(){v(t)},1)}}function m(e,t){if(document.createEventObject){var n=document.createEventObject();return e.fireEvent("on"+t,n)}else{var n=document.createEvent("HTMLEvents");n.initEvent(t,true,true);return!e.dispatchEvent(n)}}function g(t){if(i){e(i).removeClass(n.swatch_class_selected)}i=t;var r=e(t).data("settings").isClass;if(!r){e(i).addClass(n.swatch_class_selected)}spConfig.reloadPrice();e(l).children("span").remove();e(l).append(e("<span></span>").html(" "+e(t).data("settings").color));if(n.use_zoom){e("p.product-image img").remove();e("p.product-image").append(e("<a></a>").attr({href:e(t).data("settings").zoom_src,"class":"cloud-zoom",id:"cloudZoom",rel:"zoomWidth: '300',zoomHeight: '300',position: 'right',smoothMove: 3,showTitle: true,titleOpacity: 0,lensOpacity: 0,tintOpacity: 0,softFocus: false"}).append(e("<img />").attr("src",e(t).data("settings").large_src)))}else{e("p.product-image img").attr("src",e(t).data("settings").large_src)}s=0;v(e(t).data("settings").color_id);y(t)}function y(t){var r,i;var s=e(t).data("settings").thumbs;e(".more-views ul").remove();var o=e("<ul></ul>").appendTo(".more-views");if(n.use_zoom){e.each(s,function(t,n){e(o).append(e("<li></li>").append(e("<a></a>").attr({rel:"useZoom: 'cloudZoom', smallImage: '"+n.large_src+"'",href:n.zoom_src}).addClass("cloud-zoom-gallery").append(e("<img />").attr("src",n.thumb_src))))});e(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()}else{e.each(s,function(t,n){e(o).append(e("<li></li>").append(e("<a></a>").attr("href","#").append(e("<img />").attr("src",n.thumb_src)).click(function(){e("p.product-image img").attr("src",n.large_src)})))})}}function b(t,n,r,i,s,o){e.ajax({type:t,url:n,data:r,dataType:i,beforeSend:s,success:o,error:w})}function w(e,t,n){console.log(t)}function E(e){var t=0;for(elem in o){if(t==e){return elem}t++}}var r=e(t);var i="";var s=0;var o=[];var u=true;var a=false;var f=e("#attribute272").parent().parent();e("#"+n.swatch_container).appendTo(e(f));if(n.hide_color_dropdown){e("#attribute272").hide()}var l=e(f).siblings("dt")[0];if(n.assoc_products_url){var c={product_id:n.product_id,thumb_size:n.thumb_size,large_size:n.large_size,zoom_size:n.zoom_size};b("GET",n.assoc_products_url,c,"text","",h)}};e.configurableColors.defaults={product_id:"",sp_config:"",assoc_products_url:"",swatch_container:"",swatch_class:"",swatch_class_selected:"",hide_color_dropdown:false,thumb_size:"",large_size:"",zoom_size:"",use_zoom:true}})(jQuery)